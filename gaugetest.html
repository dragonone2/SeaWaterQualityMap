<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>불릿 차트 예</title>
    <script src="https://d3js.org/d3.v6.min.js"></script>
    <style>
        .chart rect {
            stroke: #000;
            stroke-width: 1px;
        }
    </style>
</head>
<body>
<div id="bullet-chart"></div>
<script>
    const data = {
        title: "예제 불릿 차트",
        subtitle: "실적/목표",
        value: 80,
        maxValue: 150
    };

    const drawBulletChart = (data, selector) => {
        const width = 600;
        const height = 50;

        const svg = d3.select(selector)
            .append('svg')
            .attr('width', width)
            .attr('height', height);

        const x = d3.scaleLinear()
            .domain([0, data.maxValue])
            .range([0, width]);

        // 배경 구간을 5단계로 나눕니다.
        const step = data.maxValue / 5;
        const ranges = Array.from({length: 5}, (_, i) => i * step);

        // 배경 구간
        svg.append('g')
            .attr('class', 'chart')
            .selectAll('rect.range')
            .data(ranges.map((d, i) => [d, d + step]))
            .enter().append('rect')
            .attr('class', 'range')
            .attr('x', d => x(d[0]))
            .attr('width', d => x(d[1]) - x(d[0]))
            .attr('height', height)
            .style('fill', (d, i) => d3.interpolateBlues((i + 1) / 5));

        // 빨간색 선
        svg.append('g')
            .selectAll('line.marker')
            .data([data.value])
            .enter().append('line')
            .attr('class', 'marker')
            .attr('x1', x)
            .attr('x2', x)
            .attr('y1', 0)
            .attr('y2', height)
            .style('stroke', '#f00')
            .style('stroke-width', '3px');

        // 제목 및 설명
        svg.append('text')
            .attr('x', 0)
            .attr('y', height + 20)
            .text(data.title)
            .style('font-size', '14px');

        svg.append('text')
            .attr('x', 0)
            .attr('y', height + 40)
            .text(data.subtitle)
            .style('font-size', '12px');
    };

    drawBulletChart(data, '#bullet-chart');
</script>
</body>
</html>
