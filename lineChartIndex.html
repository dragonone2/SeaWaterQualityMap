<!DOCTYPE html>
<html>
<head>
    <style>
        #chart-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-gap: 20px;
        }
        canvas {
            width: 100% !important;
            max-width: 800px;
            height: auto !important;
        }
    </style>
</head>
<body>
    <div id="chart-container">
        <canvas id="chart-ph"></canvas>
        <canvas id="chart-do"></canvas>
        <canvas id="chart-tn"></canvas>
        <canvas id="chart-tp"></canvas>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.5.1/chart.min.js"></script>
    <script>
        window.onload = function() {
            var files = ['2018_Ocean.csv', '2019_Ocean.csv', '2020_Ocean.csv', '2021_Ocean.csv', '2022_Ocean.csv'];
            var dataByParameter = {};
            var labels = ["수소이온농도pH", "용존산소량DO (㎎/ℓ)", "총질소TN (㎍/ℓ)", "총인TP (㎍/ℓ)"];
            var canvasIds = ["chart-ph", "chart-do", "chart-tn", "chart-tp"];

            labels.forEach(label => dataByParameter[label] = []);

            files.forEach((file, index) => {
                Papa.parse(file, {
                    download: true,
                    complete: function(results) {
                        var data = results.data;

                        labels.forEach(label => {
                            var values = []; // Values for "속초연안"

                            for (var i = 2; i < data.length; i++) {
                                if (data[i][1] === "속초연안") {
                                    var columnIndex = data[1].indexOf(label);
                                    if (columnIndex !== -1) {
                                        values.push(parseFloat(data[i][columnIndex]));
                                    }
                                }
                            }

                            dataByParameter[label].push({
                                x: file.replace('_Ocean.csv', ''), // Remove '_Ocean.csv' from the file name
                                y: values[0] // Assuming each file contains one row of data for "속초연안"
                            });
                        });

                        if (Object.values(dataByParameter)[0].length === files.length) {
                            labels.forEach((label, index) => {
                                drawChart(canvasIds[index], label, dataByParameter[label]);
                            });
                        }
                    }
                });
            });
        };

        function drawChart(canvasId, label, data) {
            var ctx = document.getElementById(canvasId).getContext('2d');

            new Chart(ctx, {
                type: 'line',
                data: {
                    datasets: [{
                        label: label,
                        data: data,
                        fill: false,
                        borderColor: `rgba(${Math.random() * 255}, ${Math.random() * 255}, ${Math.random() * 255}, 1)`,
                        tension: 0.1
                    }]
                },
                options: {
                    scales: {
                        x: {
                            type: 'category',
                            title: {
                                display: true,
                                text: '년도'
                            }
                        },
                        y: {
                            type: 'linear',
                            title: {
                                display: true,
                                text: '수치'
                            }
                        }
                    }
                }
            });
        }
    </script>
</body>
</html>
